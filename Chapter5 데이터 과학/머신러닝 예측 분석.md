# 머신러닝 모델
## 머신러닝 모델이란?
머신러닝 모델은 함수와 비슷함. 머신러닝 모델도 값을 입력하면 정해진 규칙에 따라 계산한 예측값을 출력함. 머신러닝 모델이 함수와 다른 점은 만드는 방법.
머신러닝 모델을 만들 때는 사람이 계산 규칙을 정하지 않고 컴퓨터가 데이터에서 패턴을 찾아 스스로 규칙을 정하게 함.

### 예측 변수와 타겟 변수
머신러닝 모델을 만들 때 두 종류의 변수를 사용함.
* 예측 변수(predictor variable): 예측하는 데 활용하는 변수 또는 모델에 입력하는 값.
* 타겟 변수(target variable): 예측하고자 하는 변수 또는 모델이 출력하는 값.

환자의 성별, 나이 흡연 여부, 음주 여부로 당뇨병 발병을 예측하는 모델을 만든다면 성별, 나이, 흡연 여부, 음주 여부는 예측 변수로 사용. 당뇨병 발병 여부는 타겟 변수로 사용.

### 머신러닝 모델을 이용해 미래 예측
미래의 값을 예측하는 용도로 자주 사용됨. 과거의 값을 예측 변수, 미래의 값을 타겟 변수로 사용하면 됨.  
머신러닝 모델은 다양한 사업 영역에서 미래를 예측하는 데 활용됨. 미래를 예측하면 부가 수익을 창출하고 비용을 줄일 수 있으므로 머신러닝은 여러 분야에서 주목받는 기술.

## 의사결정나무 모델(decision tree)
종류가 매우 다양하고 새로운 알고리즘이 끊임없이 개발되고 있음. 의사결정나무 모델은 구조가 단순하고 작동 원리를 이해하기 쉬워 여러 분야에 사용됨. 규모가 크고 복잡한 모델도 의사결정나무 모델에 기반을 두고 만들 때가 많음.

### 의사결정나무 모델이란?
의사결정나무 모델은 순서대로 주어진 질문에 yes/no로 답하면 마지막에 결론을 얻는 구조.

### 의사결정나무 모델을 이용해 예측
최종적으로 둘 중 한 가지 값으로 분류하는 모델은 이진 분류 모델(binary classification model).  
셋 이상의 값으로 분류하는 모델은 다중 분류 모델(multiclass classification model).

### 의사결정나무 모델 원리
* 예측 변수: 흡연 여부, 음주 여부, 성별, 나이
* 타겟 변수: 당뇨병 발병 여부

#### 1단계: 타겟 변수를 가장 잘 분리하는 예측 변수 선택
의사결정나무 모델은 어떤 순서로 어떤 질문을 할지 정하는 과정을 거쳐 만들어짐. 첫 번째 질문을 할 때 예측 변수 중에서 무엇을 사용할지 정함.
'타겟 변수를 가장 잘 분리해 주는 예측 변수'를 찾아 첫 번째 질문으로 삼음. 예측 변수가 타겟 변수를 분리해 주는 정도는 아래 절차로 알 수 있음.

1. 모든 예측 변수를 yes/no로 답할 수 있는 질문으로 만듦
2. 모델을 만드는데 사용할 데이터를 앞에서 만든 각각의 질문에 대입한 다음 'yes'로 답한 데이터만 추출함.
3. 발병인과 정상인의 비율을 구함. 비율 차이가 크면 클수록 예측 변수가 타겟 변수를 잘 분리하는 것.

연속 변수는 타겟 변수를 가장 잘 분리해 주는 기준을 알아내려면 모든 경우의 수대로 질문 후보를 만들어 비교함.  
모든 예측 변수로 질문을 만든 다음 타겟 변수를 가장 잘 분리해 주는 변수를 찾아 첫 번째 질문에 사용함. 실제 계산에서는 노드 분리 전후를 비교하여 지니 계수(gini index)나 엔트로피(entropy)와 같은 불순도(impurity)를 가장 줄여주는 예측 변수를 선택함.

#### 2단계: 첫 번째 질문의 답변에 따라 데이터를 두 노드로 분할
질문의 답변이 같아서 함께 분류된 집단을 노드(node)라고 함. 의사결정나무 도식에 사각형으로 표현됨.

#### 3단계: 각 노드에서 타겟 변수를 가장 잘 분리하는 예측 변수 선택
각 노드에서 타겟 변수를 가장 잘 분리해 주는 예측 변수 선택. 1단계 작업을 노드별로 반복하는 것.

#### 4단계: 노드가 완벽하게 분리될 때까지 반복
한 범주만 남아 완벽하게 분리될 때까지 변수를 선택하고 노드를 분할하는 과정을 반복함.

### 의사결정나무 모델 특징
#### 노드마다 분할 횟수가 다름
예측 변수를 선택하고 노드를 분할하는 횟수가 노드마다 다르므로 가지가 뻗어 나간 횟수도 노드마다 제각각.

#### 노드마다 선택되는 예측 변수가 다름
예측 변수 선택 작업을 노드별로 따로 하므로 노드마다 선택되는 변수가 다름.

#### 어떤 예측 변수는 모델에서 탈락
어떤 예측 변수는 노드를 분할하는 과정에서 한 번도 선택되지 않아 모델에서 탈락할 수 있음. 데이터에 들어 있는 모든 변수를 예측해 사용하는 게 아니라 일부는 사용하고 일부는 제외.
